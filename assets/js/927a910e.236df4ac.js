"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[117],{495:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var i=n(4848),s=n(8453);const o={sidebar_position:8},r="How to check if the user is logged in",c={id:"howto/how-to-check-if-the-user-is-logged-in",title:"How to check if the user is logged in",description:"Task",source:"@site/docs/howto/how-to-check-if-the-user-is-logged-in.md",sourceDirName:"howto",slug:"/howto/how-to-check-if-the-user-is-logged-in",permalink:"/LmcUser/docs/howto/how-to-check-if-the-user-is-logged-in",draft:!1,unlisted:!1,editUrl:"https://github.com/lm-commons/lmcuser/tree/master/docs/docs/howto/how-to-check-if-the-user-is-logged-in.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"documentationSidebar",previous:{title:"How to modify the login and/or registration form timeout",permalink:"/LmcUser/docs/howto/how-to-modify-the-login-and-or-registration-form-timeout"},next:{title:"How to change password and email (not complete)",permalink:"/LmcUser/docs/howto/how-to-change-password-and-email"}},h={},l=[{value:"Task",id:"task",level:2},{value:"Solution",id:"solution",level:2},{value:"View",id:"view",level:3},{value:"Controller",id:"controller",level:3},{value:"Service Manager",id:"service-manager",level:3}];function a(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"how-to-check-if-the-user-is-logged-in",children:"How to check if the user is logged in"}),"\n",(0,i.jsx)(t.h2,{id:"task",children:"Task"}),"\n",(0,i.jsx)(t.p,{children:"Check if the user is logged in (ie: user identity widget)"}),"\n",(0,i.jsx)(t.h2,{id:"solution",children:"Solution"}),"\n",(0,i.jsx)(t.p,{children:"There are three ways."}),"\n",(0,i.jsx)(t.h3,{id:"view",children:"View"}),"\n",(0,i.jsxs)(t.p,{children:["LmcUser provides a View Helper (",(0,i.jsx)(t.a,{href:"https://github.com/LM-Commons/LmcUser/blob/master/src/LmcUser/View/Helper/LmcUserIdentity.php",children:"lmcUserIdentity"}),") which you can use from any view script in your application."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"\x3c!-- Test if the User is connected --\x3e\n<?php if(!$this->lmcUserIdentity()): ?>\n    \x3c!-- display the login form --\x3e\n    <?php echo $this->lmcUserLoginWidget(['redirect'=>'application']); ?>\n<?php else: ?>\n    \x3c!-- display the 'display name' of the user --\x3e\n    <?php echo $this->lmcUserIdentity()->getDisplayname(); ?>\n<?php endif?>\n"})}),"\n",(0,i.jsx)(t.p,{children:"You can also get user's fields (if the user is logged in), like email:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"<?php echo $this->lmcUserIdentity()->getEmail(); ?>\n"})}),"\n",(0,i.jsx)(t.h3,{id:"controller",children:"Controller"}),"\n",(0,i.jsxs)(t.p,{children:["LmcUser provides a Controller Plugin (",(0,i.jsx)(t.a,{href:"https://github.com/LM-Commons/LmcUser/blob/master/src/LmcUser/Controller/Plugin/LmcUserAuthentication.php",children:"lmcUserAuthentication"}),") which you can use from any controller in your application. You can check if the user is connected and get his data:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"<?php\nif ($this->lmcUserAuthentication()->hasIdentity()) {\n    //get the email of the user\n    echo $this->lmcUserAuthentication()->getIdentity()->getEmail();\n    //get the user_id of the user\n    echo $this->lmcUserAuthentication()->getIdentity()->getId();\n    //get the username of the user\n    echo $this->lmcUserAuthentication()->getIdentity()->getUsername();\n    //get the display name of the user\n    echo $this->lmcUserAuthentication()->getIdentity()->getDisplayname();\n}\n?>\n"})}),"\n",(0,i.jsxs)(t.p,{children:["You can get the ",(0,i.jsx)(t.code,{children:"lmcuser_auth_service"})," in a controller by doing:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"$authService = $this->lmcUserIdentity()->getAuthService();\n"})}),"\n",(0,i.jsx)(t.h3,{id:"service-manager",children:"Service Manager"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-php",children:"<?php\n$sm = $app->getServiceManager();\n$auth = $sm->get('lmcuser_auth_service');\nif ($auth->hasIdentity()) {\n    echo $auth->getIdentity()->getEmail();\n}\n?>\n"})})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var i=n(6540);const s={},o=i.createContext(s);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);